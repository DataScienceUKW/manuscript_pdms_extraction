<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nikolas B. Schrader">
<meta name="author" content="Burkhard Meißner">
<meta name="author" content="Paul Fischer">
<meta name="author" content="Daniel Röder">
<meta name="author" content="Maximilian Ertl">
<meta name="author" content="Benedikt Schmid">

<title>Extraction and Processing of Intensive Care Chart Data from a Patient Data Management System (PDMS)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a74871fe4945b66d259aafc266475145.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


<meta name="citation_title" content="Extraction and Processing of Intensive Care Chart Data from a Patient Data Management System (PDMS)">
<meta name="citation_author" content="Nikolas B. Schrader">
<meta name="citation_author" content="Burkhard Meißner">
<meta name="citation_author" content="Paul Fischer">
<meta name="citation_author" content="Daniel Röder">
<meta name="citation_author" content="Maximilian Ertl">
<meta name="citation_author" content="Benedikt Schmid">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Lifting Hospital Electronic Health Record Data Treasures: Challenges and Opportunities;,citation_abstract=Electronic health records (EHRs) have been successfully used in data science and machine learning projects. However, most of these data are collected for clinical use rather than for retrospective analysis. This means that researchers typically face many different issues when attempting to access and prepare the data for secondary use. We aimed to investigate how raw EHRs can be accessed and prepared in retrospective data science projects in a disciplined, effective, and efficient way. We report our experience and findings from a large-scale data science project analyzing routinely acquired retrospective data from the Kepler University Hospital in Linz, Austria. The project involved data collection from more than 150,000 patients over a period of 10 years. It included diverse data modalities, such as static demographic data, irregularly acquired laboratory test results, regularly sampled vital signs, and high-frequency physiological waveform signals. Raw medical data can be corrupted in many unexpected ways that demand thorough manual inspection and highly individualized data cleaning solutions. We present a general data preparation workflow, which was shaped in the course of our project and consists of the following 7 steps: obtain a rough overview of the available EHR data, define clinically meaningful labels for supervised learning, extract relevant data from the hospital’s data warehouses, match data extracted from different sources, deidentify them, detect errors and inconsistencies therein through a careful exploratory analysis, and implement a suitable data processing pipeline in actual code. Only few of the data preparation issues encountered in our project were addressed by generic medical data preprocessing tools that have been proposed recently. Instead, highly individualized solutions for the specific data used in one’s own research seem inevitable. We believe that the proposed workflow can serve as a guidance for practitioners, helping them to identify and address potential problems early and avoid some common pitfalls.;,citation_author=Alexander Maletzky;,citation_author=Carl Böck;,citation_author=Thomas Tschoellitsch;,citation_author=Theresa Roland;,citation_author=Helga Ludwig;,citation_author=Stefan Thumfart;,citation_author=Michael Giretzlehner;,citation_author=Sepp Hochreiter;,citation_author=Jens Meier;,citation_publication_date=2022-10;,citation_cover_date=2022-10;,citation_year=2022;,citation_issue=10;,citation_doi=10.2196/38557;,citation_issn=2291-9694;,citation_pmid=36269654;,citation_volume=10;,citation_journal_title=JMIR medical informatics;">
<meta name="citation_reference" content="citation_title=Implications of Data Extraction and Processing of Electronic Health Records for Epidemiological Research: Observational Study;,citation_abstract=AbstractBackground The use of routinely recorded electronic health record (EHR) data is increasingly common, especially in epidemiological research. However, data must be processed and prepared for secondary use, and decisions made during this process could significantly impact research outcomes. A demonstration of the extent of these consequences is necessary.Objective The aim of this study was to investigate the influence of data processing steps on research outcomes derived from the secondary use of EHR data.MethodsEHR data from 8 Dutch general practices from 2019 were used. These practices contributed data to 2 research databases: the Academic General Practitioner Development Network registry and the Nivel Primary Care Database. Data were extracted and processed through distinct extraction, transformation, and loading (ETL) pipelines, allowing the evaluation of the impact of different ETL methods by comparing the 2 datasets in three steps: (1) patient demographics, (2) epidemiology of concordant patients, and (3) health service use of patients with 3 diagnoses. A number of similarity indicators, including the number of contacts, regular consultations and visits, prescriptions, and episodes, were compared between the 2 databases. The outcomes were compared by performing paired samples t tests using 99% CIs. Prevalence, number of prescriptions, and number of regular consultations and visits per 1000 patient years were calculated and compared for 3 diagnoses (diabetes mellitus, urinary tract infection, and cough). These outcomes were compared using the SD.Results Differences were observed between the datasets in the number of enrolled patients (Academic General Practitioner Development Network registry: n=47,517; Nivel Primary Care Database: n=44,247). Despite this, patient demographics were similar. All indicator outcomes of the concordant patients showed significant differences between the databases, that is, the number of contacts, prescriptions, and episodes per patient, and the number of regular consultations and visits. Differences in the indicator outcomes for the 3 diagnosis groups varied greatly in SD, however, none of the differences were deemed significant.Conclusions The findings highlight the importance of routine health data users’ awareness of different ETL steps involved. Transparency and shared knowledge about these processes are critical, and making them available for research is necessary. Data processors should share their knowledge regarding their choices, and researchers and policy makers should invest in their knowledge of this type of metadata. Transparency and shared knowledge are particularly important in light of the European Health Data Space and the ever-increasing secondary use of routinely recorded health data. Future research should focus on the role of transparency, joint decision-making, and the minimization of effects of ETL steps, and on the insight into the individual influence of ETL steps on research outcomes. This could stimulate standardized approaches among data processors and researchers, resulting in increased data interoperability.;,citation_author=Melissa H J Van Essen;,citation_author=Robin Twickler;,citation_author=Yvette M Weesie;,citation_author=Ilgin G Arslan;,citation_author=Feikje Groenhof;,citation_author=Lilian L Peters;,citation_author=Isabelle Bos;,citation_author=Robert A Verheij;,citation_publication_date=2025-06;,citation_cover_date=2025-06;,citation_year=2025;,citation_fulltext_html_url=https://www.jmir.org/2025/1/e64628;,citation_doi=10.2196/64628;,citation_issn=1438-8871;,citation_volume=27;,citation_journal_title=Journal of Medical Internet Research;">
<meta name="citation_reference" content="citation_title=A scalable approach for critical care data extraction and analysis in an academic medical center;,citation_author=Sebastian Daniel Boie;,citation_author=Falk Meyer-Eschenbach;,citation_author=Fabian Schreiber;,citation_author=Niklas Giesa;,citation_author=Jon Barrenetxea;,citation_author=Camille Guinemer;,citation_author=Stefan Haufe;,citation_author=Michael Krämer;,citation_author=Peter Brunecker;,citation_author=Fabian Prasser;,citation_author=Felix Balzer;,citation_publication_date=2024-12;,citation_cover_date=2024-12;,citation_year=2024;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S1386505624002740;,citation_doi=10.1016/j.ijmedinf.2024.105611;,citation_issn=13865056;,citation_volume=192;,citation_journal_title=International Journal of Medical Informatics;">
<meta name="citation_reference" content="citation_title=Development and usage of an anesthesia data warehouse: Lessons learnt from a 10-year project;,citation_abstract=Abstract This paper describes the development and implementation of an anesthesia data warehouse in the Lille University Hospital. We share the lessons learned from a ten-year project and provide guidance for the implementation of such a project. Our clinical data warehouse is mainly fed with data collected by the anesthesia information management system and hospital discharge reports. The data warehouse stores historical and accurate data with an accuracy level of the day for administrative data, and of the second for monitoring data. Datamarts complete the architecture and provide secondary computed data and indicators, in order to execute queries faster and easily. Between 2010 and 2021, 636 784 anesthesia records were integrated for 353 152 patients. We reported the main concerns and barriers during the development of this project and we provided 8 tips to handle them. We have implemented our data warehouse into the OMOP common data model as a complementary downstream data model. The next step of the project will be to disseminate the use of the OMOP data model for anesthesia and critical care, and drive the trend towards federated learning to enhance collaborations and multicenter studies.;,citation_author=Antoine Lamer;,citation_author=Mouhamed Djahoum Moussa;,citation_author=Romaric Marcilly;,citation_author=Régis Logier;,citation_author=Benoit Vallet;,citation_author=Benoît Tavernier;,citation_publication_date=2023-04;,citation_cover_date=2023-04;,citation_year=2023;,citation_fulltext_html_url=https://link.springer.com/10.1007/s10877-022-00898-y;,citation_issue=2;,citation_doi=10.1007/s10877-022-00898-y;,citation_issn=1387-1307, 1573-2614;,citation_volume=37;,citation_journal_title=Journal of Clinical Monitoring and Computing;">
<meta name="citation_reference" content="citation_title=Why Is the Electronic Health Record So Challenging for Research and Clinical Care?;,citation_abstract=Abstract Background The electronic health record (EHR) has become increasingly ubiquitous. At the same time, health professionals have been turning to this resource for access to data that is needed for the delivery of health care and for clinical research. There is little doubt that the EHR has made both of these functions easier than earlier days when we relied on paper-based clinical records. Coupled with modern database and data warehouse systems, high-speed networks, and the ability to share clinical data with others are large number of challenges that arguably limit the optimal use of the EHR Objectives Our goal was to provide an exhaustive reference for those who use the EHR in clinical and research contexts, but also for health information systems professionals as they design, implement, and maintain EHR systems. Methods This study includes a panel of 24 biomedical informatics researchers, information technology professionals, and clinicians, all of whom have extensive experience in design, implementation, and maintenance of EHR systems, or in using the EHR as clinicians or researchers. All members of the panel are affiliated with Penn Medicine at the University of Pennsylvania and have experience with a variety of different EHR platforms and systems and how they have evolved over time. Results Each of the authors has shared their knowledge and experience in using the EHR in a suite of 20 short essays, each representing a specific challenge and classified according to a functional hierarchy of interlocking facets such as usability and usefulness, data quality, standards, governance, data integration, clinical care, and clinical research. Conclusion We provide here a set of perspectives on the challenges posed by the EHR to clinical and research users.;,citation_author=John H. Holmes;,citation_author=James Beinlich;,citation_author=Mary R. Boland;,citation_author=Kathryn H. Bowles;,citation_author=Yong Chen;,citation_author=Tessa S. Cook;,citation_author=George Demiris;,citation_author=Michael Draugelis;,citation_author=Laura Fluharty;,citation_author=Peter E. Gabriel;,citation_author=Robert Grundmeier;,citation_author=C. William Hanson;,citation_author=Daniel S. Herman;,citation_author=Blanca E. Himes;,citation_author=Rebecca A. Hubbard;,citation_author=Charles E. Kahn;,citation_author=Dokyoon Kim;,citation_author=Ross Koppel;,citation_author=Qi Long;,citation_author=Nebojsa Mirkovic;,citation_author=Jeffrey S. Morris;,citation_author=Danielle L. Mowery;,citation_author=Marylyn D. Ritchie;,citation_author=Ryan Urbanowicz;,citation_author=Jason H. Moore;,citation_publication_date=2021-05;,citation_cover_date=2021-05;,citation_year=2021;,citation_fulltext_html_url=http://www.thieme-connect.de/DOI/DOI?10.1055/s-0041-1731784;,citation_issue=01/02;,citation_doi=10.1055/s-0041-1731784;,citation_issn=0026-1270, 2511-705X;,citation_volume=60;,citation_journal_title=Methods of Information in Medicine;">
<meta name="citation_reference" content="citation_title=Integrating Clinical Decision Support Into Electronic Health Record Systems Using a Novel Platform (EvidencePoint): Developmental Study;,citation_abstract=Background Through our work, we have demonstrated how clinical decision support (CDS) tools integrated into the electronic health record (EHR) assist providers in adopting evidence-based practices. This requires confronting technical challenges that result from relying on the EHR as the foundation for tool development; for example, the individual CDS tools need to be built independently for each different EHR.Objective The objective of our research was to build and implement an EHR-agnostic platform for integrating CDS tools, which would remove the technical constraints inherent in relying on the EHR as the foundation and enable a single set of CDS tools that can work with any EHR.Methods We developed EvidencePoint, a novel, cloud-based, EHR-agnostic CDS platform, and we will describe the development of EvidencePoint and the deployment of its initial CDS tools, which include EHR-integrated applications for clinical use cases such as prediction of hospitalization survival for patients with COVID-19, venous thromboembolism prophylaxis, and pulmonary embolism diagnosis.Results The results below highlight the adoption of the CDS tools, the International Medical Prevention Registry on Venous Thromboembolism-D-Dimer, the Wells’ criteria, and the Northwell COVID-19 Survival (NOCOS), following development, usability testing, and implementation. The International Medical Prevention Registry on Venous Thromboembolism-D-Dimer CDS was used in 5249 patients at the 2 clinical intervention sites. The intervention group tool adoption was 77.8% (4083/5249 possible uses). For the NOCOS tool, which was designed to assist with triaging patients with COVID-19 for hospital admission in the event of constrained hospital resources, the worst-case resourcing scenario never materialized and triaging was never required. As a result, the NOCOS tool was not frequently used, though the EvidencePoint platform’s flexibility and customizability enabled the tool to be developed and deployed rapidly under the emergency conditions of the pandemic. Adoption rates for the Wells’ criteria tool will be reported in a future publication.Conclusions The EvidencePoint system successfully demonstrated that a flexible, user-friendly platform for hosting CDS tools outside of a specific EHR is feasible. The forthcoming results of our outcomes analyses will demonstrate the adoption rate of EvidencePoint tools as well as the impact of behavioral economics “nudges”nudges on the adoption rate. Due to the EHR-agnostic nature of EvidencePoint, the development process for additional forms of CDS will be simpler than traditional and cumbersome IT integration approaches and will benefit from the capabilities provided by the core system of EvidencePoint.;,citation_author=Jeffrey Solomon;,citation_author=Katherine Dauber-Decker;,citation_author=Safiya Richardson;,citation_author=Sera Levy;,citation_author=Sundas Khan;,citation_author=Benjamin Coleman;,citation_author=Rupert Persaud;,citation_author=John Chelico;,citation_author=D’Arcy King;,citation_author=Alex Spyropoulos;,citation_author=Thomas McGinn;,citation_publication_date=2023-10;,citation_cover_date=2023-10;,citation_year=2023;,citation_fulltext_html_url=https://formative.jmir.org/2023/1/e44065;,citation_doi=10.2196/44065;,citation_issn=2561-326X;,citation_volume=7;,citation_journal_title=JMIR Formative Research;">
<meta name="citation_reference" content="citation_title=Predicting sepsis using deep learning across international sites: A retrospective development and validation study;,citation_author=Michael Moor;,citation_author=Nicolas Bennett;,citation_author=Drago Plečko;,citation_author=Max Horn;,citation_author=Bastian Rieck;,citation_author=Nicolai Meinshausen;,citation_author=Peter Bühlmann;,citation_author=Karsten Borgwardt;,citation_publication_date=2023-08;,citation_cover_date=2023-08;,citation_year=2023;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S2589537023003012;,citation_doi=10.1016/j.eclinm.2023.102124;,citation_issn=25895370;,citation_volume=62;,citation_journal_title=eClinicalMedicine;">
<meta name="citation_reference" content="citation_title=Impact of clinical registries on quality of patient care and clinical outcomes: A systematic review;,citation_author=Dewan Md Emdadul Hoque;,citation_author=Varuni Kumari;,citation_author=Masuma Hoque;,citation_author=Rasa Ruseckaite;,citation_author=Lorena Romero;,citation_author=Sue M. Evans;,citation_editor=Saravana Kumar;,citation_publication_date=2017-09;,citation_cover_date=2017-09;,citation_year=2017;,citation_fulltext_html_url=https://dx.plos.org/10.1371/journal.pone.0183667;,citation_issue=9;,citation_doi=10.1371/journal.pone.0183667;,citation_issn=1932-6203;,citation_volume=12;,citation_journal_title=PLOS ONE;">
<meta name="citation_reference" content="citation_title=Conducting Real-world Evidence Studies on the Clinical Outcomes of Diabetes Treatments;,citation_abstract=Abstract Real-world evidence (RWE), the understanding of treatment effectiveness in clinical practice generated from longitudinal patient-level data from the routine operation of the healthcare system, is thought to complement evidence on the efficacy of medications from randomized controlled trials (RCTs). RWE studies follow a structured approach. (1) A design layer decides on the study design, which is driven by the study question and refined by a medically informed target population, patient-informed outcomes, and biologically informed effect windows. Imagining the randomized trial we would ideally perform before designing an RWE study in its likeness reduces bias; the new-user active comparator cohort design has proven useful in many RWE studies of diabetes treatments. (2) A measurement layer transforms the longitudinal patient-level data stream into variables that identify the study population, the pre-exposure patient characteristics, the treatment, and the treatment-emergent outcomes. Working with secondary data increases the measurement complexity compared to primary data collection that we find in most RCTs. (3) An analysis layer focuses on the causal treatment effect estimation. Propensity score analyses have gained in popularity to minimize confounding in healthcare database analyses. Well-understood investigator errors, like immortal time bias, adjustment for causal intermediates, or reverse causation, should be avoided. To increase reproducibility of RWE findings, studies require full implementation transparency. This article integrates state-of-the-art knowledge on how to conduct and review RWE studies on diabetes treatments to maximize study validity and ultimately increased confidence in RWE-based decision making.;,citation_author=Sebastian Schneeweiss;,citation_author=Elisabetta Patorno;,citation_publication_date=2021-09;,citation_cover_date=2021-09;,citation_year=2021;,citation_fulltext_html_url=https://academic.oup.com/edrv/article/42/5/658/6169054;,citation_issue=5;,citation_doi=10.1210/endrev/bnab007;,citation_issn=0163-769X, 1945-7189;,citation_volume=42;,citation_journal_title=Endocrine Reviews;">
<meta name="citation_reference" content="citation_title=Developing a Scalable Annotation Method for Large Datasets That Enhances Alarms With Actionability Data to Increase Informativeness: Mixed Methods Approach;,citation_abstract=Background Alarm fatigue, a multifactorial desensitization of staff to alarms, can harm both patients and health care staff in intensive care units (ICUs), especially due to false and nonactionable alarms. Increasing amounts of routinely collected alarm and ICU patient data are paving the way for training machine learning (ML) models that may help reduce the number of nonactionable alarms, potentially increasing alarm informativeness and reducing alarm fatigue. At present, however, there is no publicly available dataset or process that routinely collects information on alarm actionability (ie, whether an alarm triggers a medical intervention or not), which is a key feature for developing meaningful ML models for alarm management. Furthermore, case-based manual annotation is too slow and resource intensive for large amounts of data.Objective We propose a scalable method to annotate patient monitoring alarms associated with patient-related variables regarding their actionability. While the method is aimed to be used primarily in our institution, other clinicians, scientists, and industry stakeholders could reuse it to build their own datasets.Methods The interdisciplinary research team followed a mixed methods approach to develop the annotation method, using data-driven, qualitative, and empirical strategies. The iterative process consisted of six steps: (1) defining alarm terms; (2) reaching a consensus on an annotation concept and documentation structure; (3) defining physiological alarm conditions, related medical interventions, and time windows to assess; (4) developing mapping tables; (5) creating the annotation rule set; and (6) evaluating the generated content. All decisions were made based on feasibility criteria, clinical relevance, occurrence frequency, data availability and quantity, structure, and storage mode. The annotation guideline development process was preceded by the analysis of the institution’s data and systems, the evaluation of device manuals, and a systematic literature review.Results In a multidisciplinary consensus-based approach, we defined preprocessing steps and a rule-based annotation method to classify alarms as either actionable or nonactionable based on data from the patient data management system. We have presented our experience in developing the annotation method and provided the generated resources. The method focuses on respiratory and medication management interventions and includes 8 general rules in a tabular format that are accompanied by graphical examples. Mapping tables enable handling unstructured information and are referenced in the annotation rule set.Conclusions Our annotation method will enable a large number of alarms to be labeled semiautomatically, retrospectively, and quickly, and will provide information on their actionability based on further patient data. This will make it possible to generate annotated datasets for ML models in alarm management and alarm fatigue research. We believe that our annotation method and the resources provided are universal enough and could be used by others to prepare data for future ML projects, even beyond the topic of alarms.;,citation_author=Sophie Anne Inès Klopfenstein;,citation_author=Anne Rike Flint;,citation_author=Patrick Heeren;,citation_author=Mona Prendke;,citation_author=Amin Chaoui;,citation_author=Thomas Ocker;,citation_author=Jonas Chromik;,citation_author=Bert Arnrich;,citation_author=Felix Balzer;,citation_author=Akira-Sebastian Poncette;,citation_publication_date=2025-05;,citation_cover_date=2025-05;,citation_year=2025;,citation_fulltext_html_url=https://www.jmir.org/2025/1/e65961;,citation_doi=10.2196/65961;,citation_issn=1438-8871;,citation_volume=27;,citation_journal_title=Journal of Medical Internet Research;">
<meta name="citation_reference" content="citation_title=Does adherence to a quality indicator regarding early weaning from invasive ventilation improve economic outcome? A single-centre retrospective study;,citation_abstract=Objectives To measure and assess the economic impact of adherence to a single quality indicator (QI) regarding weaning from invasive ventilation.Design Retrospective observational single-centre study, based on electronic medical and administrative records.Setting Intensive care unit (ICU) of a German university hospital, reference centre for acute respiratory distress syndrome.Participants Records of 3063 consecutive mechanically ventilated patients admitted to the ICU between 2012 and 2017 were extracted, of whom 583 were eligible adults for further analysis. Patients’ weaning protocols were evaluated for daily adherence to quality standards until ICU discharge. Patients with &amp;amp;amp;lt;&amp;lt;65% compliance were assigned to the low adherence group (LAG), patients with ≥65% to the high adherence group (HAG).Primary and secondary outcome measures Economic healthcare costs, clinical outcomes and patients’ characteristics.Results The LAG consisted of 378 patients with a median negative economic results of −€3969, HAG of 205 (−€1030), respectively (p<<0.001). Median duration of ventilation was 476 (248; 769) hours in the LAG and 389 (247; 608) hours in the HAG (p<<0.001). Length of stay (LOS) in the LAG on ICU was 21 (12; 35) days and 16 (11; 25) days in the HAG (p<<0.001). LOS in the hospital was 36 (22; 61) days in the LAG, and within the HAG, respectively, 26 (18; 48) days (p=0.001).Conclusions High adherence to this single QI is associated with better clinical outcome and improved economic returns. Therefore, the results support the adherence to QI. However, the examined QI does not influence economic outcome as the decisive factor.;,citation_author=Alexander Zuber;,citation_author=Oliver Kumpf;,citation_author=Claudia Spies;,citation_author=Moritz Höft;,citation_author=Marc Deffland;,citation_author=Robert Ahlborn;,citation_author=Jochen Kruppa;,citation_author=Roland Jochem;,citation_author=Felix Balzer;,citation_publication_date=2022-01;,citation_cover_date=2022-01;,citation_year=2022;,citation_fulltext_html_url=https://bmjopen.bmj.com/lookup/doi/10.1136/bmjopen-2020-045327;,citation_issue=1;,citation_doi=10.1136/bmjopen-2020-045327;,citation_issn=2044-6055, 2044-6055;,citation_volume=12;,citation_journal_title=BMJ Open;">
<meta name="citation_reference" content="citation_title=Information technology — database languages — SQL — part 1: Framework (SQL/framework);,citation_author=ISO/IEC;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_publisher=International Organization for Standardization;">
<meta name="citation_reference" content="citation_title=SQLAlchemy, python SQL toolkit and object relational mapper;,citation_author=Michael Bayer;,citation_author=undefined contributors;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_publisher=https://www.sqlalchemy.org/;">
<meta name="citation_reference" content="citation_title=Pdms_data_processing_pipeline;,citation_author=Nikolas B Schrader;,citation_publication_date=2025-11-14;,citation_cover_date=2025-11-14;,citation_year=2025;,citation_fulltext_html_url=https://github.com/DataScienceUKW/pdms_data_processing_pipeline;">
</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Extraction and Processing of Intensive Care Chart Data from a Patient Data Management System (PDMS)</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Nikolas B. Schrader <a href="https://orcid.org/0009-0001-4616-3804" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University Hospital Würzburg, Department of Anesthesiology, Intensive Care, Emergency and Pain Medicine
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Burkhard Meißner </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University Hospital Würzburg, Service Center Medical Informatics
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Paul Fischer </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University Hospital Würzburg, Department of Anesthesiology, Intensive Care, Emergency and Pain Medicine
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Daniel Röder <a href="https://orcid.org/0000-0001-6805-9330" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University Hospital Würzburg, Department of Anesthesiology, Intensive Care, Emergency and Pain Medicine
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Maximilian Ertl </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University Hospital Würzburg, Service Center Medical Informatics
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Benedikt Schmid <a href="https://orcid.org/0000-0003-3413-0690" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University Hospital Würzburg, Department of Anesthesiology, Intensive Care, Emergency and Pain Medicine
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#system-description" id="toc-system-description" class="nav-link" data-scroll-target="#system-description">System Description</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#data-extraction" id="toc-data-extraction" class="nav-link" data-scroll-target="#data-extraction">Data Extraction</a></li>
  <li><a href="#data-transformation-and-harmonization" id="toc-data-transformation-and-harmonization" class="nav-link" data-scroll-target="#data-transformation-and-harmonization">Data Transformation and Harmonization</a></li>
  <li><a href="#usability-and-security" id="toc-usability-and-security" class="nav-link" data-scroll-target="#usability-and-security">Usability and Security</a></li>
  </ul></li>
  <li><a href="#results-including-examples-of-use-and-limitations" id="toc-results-including-examples-of-use-and-limitations" class="nav-link" data-scroll-target="#results-including-examples-of-use-and-limitations">Results (including examples of use and limitations)</a></li>
  <li><a href="#discussion-including-scalability-and-limitations" id="toc-discussion-including-scalability-and-limitations" class="nav-link" data-scroll-target="#discussion-including-scalability-and-limitations">Discussion (including scalability and limitations)</a>
  <ul class="collapse">
  <li><a href="#ethical-and-legal-considerations" id="toc-ethical-and-legal-considerations" class="nav-link" data-scroll-target="#ethical-and-legal-considerations">Ethical and Legal Considerations</a></li>
  <li><a href="#technical-and-methodological-considerations" id="toc-technical-and-methodological-considerations" class="nav-link" data-scroll-target="#technical-and-methodological-considerations">Technical and Methodological Considerations</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The secondary use of routine clinical data from electronic health records (EHR) is an increasingly valuable resource for clinical research<span class="citation" data-cites="moor_predicting_2023 schneeweiss_conducting_2021">(<a href="#ref-moor_predicting_2023" role="doc-biblioref">1</a>,<a href="#ref-schneeweiss_conducting_2021" role="doc-biblioref">2</a>)</span>, quality improvement<span class="citation" data-cites="hoque_impact_2017">(<a href="#ref-hoque_impact_2017" role="doc-biblioref">3</a>)</span>, and the development of decision-support systems <span class="citation" data-cites="solomon_integrating_2023">(<a href="#ref-solomon_integrating_2023" role="doc-biblioref">4</a>)</span>. Intensive care medicine (ICM) and perioperative settings, in particular, generate high-frequency, multimodal data captured within Patient Data Management Systems (PDMS). While these systems ensure accurate, detailed and flexible clinical documentation, they are not designed to provide direct access for research purposes. Consequently, Extract, Transform and Load (ETL) processes for secondary data use face significant methodological and technical challenges. <span class="citation" data-cites="holmes_why_2021">(<a href="#ref-holmes_why_2021" role="doc-biblioref">5</a>)</span> Different individual approaches to address these challenges have been published before. <span class="citation" data-cites="maletzky_lifting_2022 daniel_boie_scalable_2024">(<a href="#ref-maletzky_lifting_2022" role="doc-biblioref">6</a>,<a href="#ref-daniel_boie_scalable_2024" role="doc-biblioref">7</a>)</span></p>
<p>Access to and utilization of EHR data is subject to a plethora of laws and regulations. In Germany, the secondary use of hospital routine data is governed by strict legal frameworks, including the European General Data Protection Regulation (Datenschutz-Grundverordnung, DSGVO) and the Bavarian Hospital Research Code (Krankenhausforschungsgesetz, KHG), which explicitly establish the legal basis for pseudonymized secondary use of hospital routine data for scientific purposes.</p>
<section id="system-description" class="level3">
<h3 class="anchored" data-anchor-id="system-description">System Description</h3>
<p>The Patient Data Management System (PDMS) Copra (Copra v6, COPRA System GmbH, Berlin, Germany) is a modular platform that has been widely implemented in intensive care and perioperative settings<span class="citation" data-cites="zuber_does_2022 klopfenstein_developing_2025">(<a href="#ref-zuber_does_2022" role="doc-biblioref">8</a>,<a href="#ref-klopfenstein_developing_2025" role="doc-biblioref">9</a>)</span>. Its primary function is the continuous, real-time documentation of clinical information, supporting direct patient care and ensuring medico-legal traceability. The system acquires high-frequency physiological signals (e.g., heart rate, blood pressure, ventilatory parameters), discrete clinical events (e.g., medication administrations, laboratory results, procedures), as well as structured and unstructured data such as clinical scores and narrative notes.</p>
<p>These data points are stored within a complex relational database that is optimized for transactional integrity and operational performance, ensuring reliability and consistency of bedside documentation. However, this optimization is achieved at the expense of secondary data use. The underlying database schema is highly denormalized and fragmented, often featuring data redundancy and reliance on proprietary system-specific coding instead of standardized terminologies (e.g.&nbsp;LOINC, ATC). This leads to incomplete or inconsistently implemented data capturing logic. While these design choices safeguard clinical performance and medico-legal requirements, they present considerable barriers for analytical queries, research applications, and data interoperability.</p>
<p>However, the database remains technically accessible, allowing custom extractions via direct queries and tailored transformation pipelines. This accessibility provides a foundation for research-oriented workflows, even though substantial preprocessing and harmonization are required to access the data suitable for secondary use.</p>
<p>This paper presents a structured ETL methodology for data from our institutional PDMS. We discuss the inherent data pipeline hurdles and propose replicable solutions to make high-quality, analysis-ready data accessible to the wider research community.</p>
</section>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<section id="data-extraction" class="level3">
<h3 class="anchored" data-anchor-id="data-extraction">Data Extraction</h3>
<p><em>Technical Access</em></p>
<p>To minimize the risk of affecting clinical system performance, data access was established via a secured ODBC connection to a redundant, read-only copy of the operational database. Initial extractions utilized direct Structured Query Language (SQL)<span class="citation" data-cites="ISO9075-1:2023">(<a href="#ref-ISO9075-1:2023" role="doc-biblioref">10</a>)</span>. A basic application is shown in <a href="#lst-data_extraction" class="quarto-xref">Listing&nbsp;1</a>.</p>
<div id="lst-data_extraction" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-data_extraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;1: Straight-forward query design for demographic data retrieval
</figcaption>
<div aria-describedby="lst-data_extraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Params</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @fallnr <span class="dt">NVARCHAR</span>(<span class="fu">MAX</span>) <span class="op">=</span> <span class="ch">:fallnr</span>; <span class="co">-- e.g. '123'</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    fall.FALLNR                                     <span class="kw">AS</span> case_number,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    patient.<span class="kw">ID</span>                                      <span class="kw">AS</span> patient_id,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    patient.GESCHLECHT                              <span class="kw">AS</span> patient_sex,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    TRY_CONVERT(<span class="dt">date</span>, patient.GEB)                  <span class="kw">AS</span> patient_dob,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> patient.GEB <span class="kw">IS</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="kw">NULL</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">ELSE</span> <span class="fu">CAST</span>(DATEPART(<span class="dt">year</span>, patient.GEB) <span class="kw">AS</span> <span class="dt">char</span>(<span class="dv">4</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>                                             <span class="kw">AS</span> patient_dob_yyyy,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> fall.AUFN <span class="op">&lt;</span> patient.GEB <span class="cf">THEN</span> <span class="kw">NULL</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">ELSE</span> DATEDIFF(<span class="dt">YEAR</span>, patient.GEB, fall.AUFN)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>             <span class="op">-</span> <span class="cf">CASE</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">WHEN</span> DATEADD(<span class="dt">YEAR</span>, DATEDIFF(<span class="dt">YEAR</span>, patient.GEB, fall.AUFN), patient.GEB) <span class="op">&gt;</span> fall.AUFN </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">ELSE</span> <span class="dv">0</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>               <span class="cf">END</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>                                             <span class="kw">AS</span> patient_age_at_admission,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> CO6_Medic_Data_Fall <span class="kw">AS</span> fall</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> CO6_Medic_Data_Patient <span class="kw">AS</span> patient</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> fall.Patient_ID <span class="op">=</span> patient.<span class="kw">ID</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> patient.deleted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> fall.FALLNR <span class="op">=</span> @fallnr</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> fall.deleted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> fall.FALLNR;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>Other, more relational data structures required a more complex extraction algorithm to ensure accurate outputs. Here, we describe the extraction of point-of-care blood gas analysis results (<a href="#lst-extraxtion_BGA" class="quarto-xref">Listing&nbsp;2</a>).</p>
<div id="lst-extraxtion_BGA" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-extraxtion_BGA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;2: Complex query design for relational data structures and content-aware filtering, e.g.&nbsp;in point-of-care diagnostic applications.
</figcaption>
<div aria-describedby="lst-extraxtion_BGA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Params</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @fallnr       <span class="dt">nvarchar</span>(<span class="dv">50</span>)  <span class="op">=</span> <span class="fu">CONVERT</span>(<span class="dt">nvarchar</span>(<span class="dv">50</span>), <span class="ch">:fallnr</span>);          <span class="co">-- e.g. '123'</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @from_ts      datetime2(<span class="dv">0</span>)  <span class="op">=</span> TRY_CONVERT(datetime2(<span class="dv">0</span>), <span class="ch">:start_date</span>);  <span class="co">-- optional</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @to_ts        datetime2(<span class="dv">0</span>)  <span class="op">=</span> TRY_CONVERT(datetime2(<span class="dv">0</span>), <span class="ch">:end_date</span>);    <span class="co">-- optional (exclusive)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">IF</span> OBJECT_ID(<span class="st">'tempdb..#base_bga'</span>) <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DROP</span> <span class="kw">TABLE</span> #base_bga;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">-- Base for all non-SWISSLAB systems (e.g., ABL/POCT)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    f.FALLNR,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    lab.val,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    lab.Unit,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    lab.DateTimeTo,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    labvar.<span class="kw">ID</span>           <span class="kw">AS</span> LabvarID,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    labvar.COPRAName,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    labvar.LaborSystem,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">WHEN</span> labvar.LaborSystem <span class="kw">LIKE</span> <span class="st">'ABL%'</span> <span class="kw">OR</span> labvar.LaborSystem <span class="kw">LIKE</span> <span class="st">'POCT%'</span> <span class="cf">THEN</span> <span class="st">'POCT'</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">ELSE</span> labvar.LaborSystem</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span> <span class="kw">AS</span> SystemGroup</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span> #base_bga</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> CO6_Medic_Data_Labor <span class="kw">AS</span> lab</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> CO6_Medic_Config_LaborVariables <span class="kw">AS</span> labvar</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> lab.LaborVariable <span class="op">=</span> labvar.<span class="kw">ID</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> (</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> Patient_ID, FALLNR</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> CO6_Medic_Data_Fall</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> FALLNR <span class="op">=</span> @fallnr</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>) <span class="kw">AS</span> f</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> lab.Parent_ID <span class="op">=</span> f.Patient_ID</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> lab.deleted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> lab.FlagCurrent <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> labvar.LaborSystem <span class="op">&lt;&gt;</span> <span class="st">'SWISSLAB'</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> (@from_ts <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> lab.DateTimeTo <span class="op">&gt;=</span> @from_ts)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> (@to_ts   <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">OR</span> lab.DateTimeTo <span class="op">&lt;</span>  @to_ts);</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">-- Dynamic column list (exluding Bemerkung)</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @cols_bga <span class="dt">nvarchar</span>(<span class="fu">max</span>);</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> @cols_bga <span class="op">=</span> STRING_AGG(QUOTENAME(COPRAName), <span class="st">','</span>) WITHIN <span class="kw">GROUP</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> COPRAName)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> COPRAName <span class="kw">FROM</span> #base_bga <span class="kw">WHERE</span> COPRAName <span class="op">&lt;&gt;</span> <span class="st">'Bemerkung'</span>) d;</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="cf">IF</span> @cols_bga <span class="kw">IS</span> <span class="kw">NULL</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="cf">BEGIN</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">CAST</span>(<span class="kw">NULL</span> <span class="kw">AS</span> <span class="dt">nvarchar</span>(<span class="dv">50</span>)) <span class="kw">AS</span> FALLNR,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>         <span class="fu">CAST</span>(<span class="kw">NULL</span> <span class="kw">AS</span> <span class="dt">nvarchar</span>(<span class="dv">50</span>)) <span class="kw">AS</span> SystemGroup,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>         <span class="fu">CAST</span>(<span class="kw">NULL</span> <span class="kw">AS</span> datetime2(<span class="dv">0</span>)) <span class="kw">AS</span> DateTimeTo,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>         <span class="fu">CAST</span>(<span class="kw">NULL</span> <span class="kw">AS</span> <span class="dt">nvarchar</span>(<span class="dv">200</span>)) <span class="kw">AS</span> [<span class="kw">Type</span>];</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="kw">RETURN</span>;</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span>;</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pivot</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="kw">DECLARE</span> @sql_bga <span class="dt">nvarchar</span>(<span class="fu">max</span>) <span class="op">=</span> N<span class="st">'</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT FALLNR, SystemGroup, DateTimeTo, [Type], '</span> <span class="op">+</span> @cols_bga <span class="op">+</span> N<span class="st">'</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="st">FROM (</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="st">      b.FALLNR,</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="st">      b.SystemGroup,</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="st">      b.DateTimeTo,</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="st">      (</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT STRING_AGG(v.val, </span><span class="ch">''</span><span class="st">, </span><span class="ch">''</span><span class="st">)</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM (</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="st">          SELECT DISTINCT bx.val</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="st">          FROM #base_bga AS bx</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="st">          WHERE bx.SystemGroup = b.SystemGroup</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="st">            AND bx.DateTimeTo  = b.DateTimeTo</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="st">            AND bx.COPRAName   = </span><span class="ch">''</span><span class="st">Bemerkung</span><span class="ch">''</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="st">        ) AS v</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="st">      ) AS [Type],</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="st">      b.COPRAName,</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="st">      CONCAT(b.val, COALESCE(</span><span class="ch">''</span><span class="st"> </span><span class="ch">''</span><span class="st"> + b.Unit, </span><span class="ch">''''</span><span class="st">)) AS val</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM #base_bga AS b</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE b.COPRAName &lt;&gt; </span><span class="ch">''</span><span class="st">Bemerkung</span><span class="ch">''</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="st">) AS s</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="st">PIVOT (</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="st">  MAX(val) FOR COPRAName IN ('</span> <span class="op">+</span> @cols_bga <span class="op">+</span> N<span class="st">')</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="st">) AS p</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY FALLNR, DateTimeTo, SystemGroup, [Type];'</span>;</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="kw">EXEC</span> sys.sp_executesql @sql_bga;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>As research demands expanded, a dedicated Python-based extraction framework was developed, using SQLAlchemy as an abstraction layer <span class="citation" data-cites="sqlalchemy_software">(<a href="#ref-sqlalchemy_software" role="doc-biblioref">11</a>)</span>. This framework enabled reusable workflows across data domains (vital signs, therapies, medications), automated preprocessing steps such as time stamp conversion (UTC to CET/CEST), and implemented clinically necessary logic to address inconsistencies in documentation.</p>
<p>For example, documentation of device usage or therapy intervals often lacked explicit termination markers (end times). Furthermore, reverification of ongoing therapies always produced additional entries for the same treatment, resulting in multiple records for a single continuous intervention. Identifying truly ongoing interventions versus documentation gaps was therefore critical. To address this, an interval-based logic was introduced that heuristically cross-referenced therapy records with patient bed occupancy data to infer missing end times and to rejoin fragmented therapy intervals into continuous episodes.</p>
<p>This modular pipeline facilitated reproducibility, improved transparency, and reduced errors compared with ad hoc SQL queries. To comply with legal requirements, the framework included an auditing mechanism for user-specific request logging and an integrated hashing for sensitive parameters.</p>
</section>
<section id="data-transformation-and-harmonization" class="level3">
<h3 class="anchored" data-anchor-id="data-transformation-and-harmonization">Data Transformation and Harmonization</h3>
<p>Extracted PDMS data required systematic data cleaning and restructuring. A modular transformation framework was implemented in Python, wherein each clinical domain (vital signs, medications, laboratory values, devices, demographics) was processed by a dedicated service module. Pydantic models defined the output, enforcing type safety, plausibility checks, and schema consistency.</p>
<p><em>Temporal Processing</em></p>
<p>All data streams were normalized to Central European Time (CET/CEST). For event-based records such as laboratory results or medication administrations, only the time stamps were converted. No additional aggregation or alignment was applied at this stage.</p>
<p><em>Vital Signs</em></p>
<p>Most numeric values (e.g.&nbsp;blood pressure, heart rate, ventilator parameters) were consistently stored with predefined units in the PDMS. Consequently minimal harmonization was required beyond plausibility filtering and time standardization.</p>
<p><em>Medications</em></p>
<p>Medication data required the most extensive processing. Documentation occurred in various formats (volume, dose, or rate), and drug concentrations were often not explicitly available. Concentrations were therefore reconstructed from ingredient definitions using internal reference catalogs and classification algorithms. This step was essential to derive standardized application rates (e.g., mg/h, U/h) across projects.</p>
<p><em>Devices and Therapies</em></p>
<p>Support devices such as ECMO, dialysis, Impella, or intra-aortic balloon pump (IABP) were documented as intervals, but end times were frequently missing. To resolve this, therapy records were cross-referenced with patient bed occupancy and related device tables, allowing inference of active versus terminated therapies.</p>
<p><em>Internal Catalogs and Variable Definitions</em></p>
<p>Since international terminologies (e.g., LOINC, ATC) were unavailable in the source system, harmonization relied on internally maintained catalogs. These provided stable, project-wide definitions for drugs, laboratory parameters, and device attributes, serving as the central reference for variable identifiers to ensure consistency across service modules.</p>
<p><em>Output and Validation</em></p>
<p>Each service produced a validated, patient-centered output model. Primary validation via pydantic enforced schema conformity, rejected clinically implausible values, and ensured consistency. Final outputs were stored in structured, analysis-ready formats (CSV or Parquet) with standardized variable naming. Secondary validation involved a sample-based auditing process, comparing extracted data against values displayed in the clinical PDMS front end to confirm consistency.</p>
</section>
<section id="usability-and-security" class="level3">
<h3 class="anchored" data-anchor-id="usability-and-security">Usability and Security</h3>
<p>To make the extraction framework accessible beyond technically trained users, a lightweight front-end interface was implemented. The front-end interface incorporated fine-grained user-based access control and audit logging, fulfilling institutional governance requirements as well as the traceability and accountability obligations defined under DSGVO (Art. 5, 32) and §27 KHG.</p>
<p>Predefined extraction templates for common research domains (e.g., epidemiology, vital parameters) provide standardized, validated data pipelines and minimize the risk of sensitive identifier (e.g., patient name, date of birth) retrieval. Extractions were tied to case numbers, enabling clinicians and researchers to obtain datasets relevant to specific trials or patient groups without requiring direct SQL interaction. De-identification of sensitive parameters was achieved by hashing.</p>
<p>By abstracting low-level query complexity from end-user access, we reduced the risk of unintended database interference and promoted data integrity. In combination, the flexible back-end workflows and secure front-end interface created a scalable, reproducible, and governance-compliant process for secondary use of PDMS data.</p>
<p>We implemented a scalable and modular pipeline for automated data extraction from the institutional patient data management system (PDMS, Copra). Although each data category still requires its own extraction and transformation logic, the framework provides standardized, reproducible, and legally compliant access to routine clinical data. In our institutional environment, the system currently supports multiple data domains including demographics, vital signs, and laboratory results—through predefined, configurable templates. Integrated auditing and de-identification components provide full traceability and pseudonymization in compliance with the General Data Protection Regulation (DSGVO) and §27 KHG.</p>
<p>A simplified version of the extraction framework is publicly available on GitHub <span class="citation" data-cites="schrader_pdms_pipeline_2025">(<a href="#ref-schrader_pdms_pipeline_2025" role="doc-biblioref">12</a>)</span>, demonstrating the demographic-data workflow as an illustrative example. The full implementation in our hospital environment cannot be shared in its operational form, as extraction and transformation logic must be tailored to the institution-specific PDMS schema and is therefore neither directly portable nor readily interpretable outside our setting.</p>
</section>
</section>
<section id="results-including-examples-of-use-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="results-including-examples-of-use-and-limitations">Results (including examples of use and limitations)</h2>
<p>To demonstrate the operational functionality of the implemented pipeline, we executed a demographic extraction for two cases using the predefined template. The extraction completed successfully and produced both a pseudonymized output table and a comprehensive audit record documenting all parameters, derived fields, and user actions.</p>
<p>The audit log shows that the pipeline consistently applied the configured logic, including pseudonymization of identifiers, derivation of age from date of birth, and the recording of requested fields. The corresponding CSV output demonstrates that the system generates structured, analysis-ready datasets with standardized variable naming.</p>
<p>In routine internal use, the pipeline has replaced ad hoc SQL-based retrieval for common data domains and has reproducibly generated identical outputs for repeated extractions with the same input parameters. These observations indicate stable system behavior and demonstrate that the implemented workflows enable reliable secondary use of PDMS data within our institutional environment.</p>
<section id="example-usage-of-the-pipeline-for-demographic-data-extraction-audit-and-de-identification." class="level4">
<h4 class="anchored" data-anchor-id="example-usage-of-the-pipeline-for-demographic-data-extraction-audit-and-de-identification.">Example usage of the pipeline for demographic data extraction, audit and de-identification.</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pipeline.audit_logger <span class="im">import</span> AuditLogger</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pipeline.extraction_pipeline <span class="im">import</span> run_demographics</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>audit <span class="op">=</span> AuditLogger(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    path<span class="op">=</span><span class="st">"logs/audit.jsonl"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    include_id_samples<span class="op">=</span><span class="va">True</span>,   <span class="co"># Show sample IDs in internal audit logs</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    id_hash_salt<span class="op">=</span><span class="va">None</span>           <span class="co"># Or set a salt to hash IDs in audit logs</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> run_demographics(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span><span class="st">"cases"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    ids<span class="op">=</span>[<span class="st">"123"</span>, <span class="st">"234"</span>],</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"case_number"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"patient_sex"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"patient_age_today"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    hash_salt<span class="op">=</span><span class="st">"custom_demographics_salt"</span>,  <span class="co"># Salt for hashing IDs in output</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    out<span class="op">=</span><span class="st">"out/demographics.csv"</span>,             <span class="co"># Output CSV path or None to disable export</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    audit<span class="op">=</span>audit,                           <span class="co"># AuditLogger instance or None to disable auditing</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    actor<span class="op">=</span><span class="st">"n.schrader"</span>,                    <span class="co"># Identifier for the actor triggering extraction</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>audit.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The corresponding audit log and output file document all parameters, derived fields, and pseudonymized identifiers, demonstrating transparent, auditable access to high-quality PDMS data suitable for secondary use in research and quality improvement projects.</p>
<p><strong>logs/audit.jsonl</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"ts"</span><span class="fu">:</span> <span class="st">"2025-11-12T10:39:57.193437+01:00"</span><span class="fu">,</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"actor"</span><span class="fu">:</span> <span class="st">"n.schrader"</span><span class="fu">,</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"action"</span><span class="fu">:</span> <span class="st">"fetch"</span><span class="fu">,</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"resource"</span><span class="fu">:</span> <span class="st">"demographics"</span><span class="fu">,</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"by"</span><span class="fu">:</span> <span class="st">"cases"</span><span class="fu">,</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"ids"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"count"</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span> <span class="dt">"ids"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"123"</span><span class="ot">,</span> <span class="st">"234"</span><span class="ot">]</span><span class="fu">},</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"fields_requested"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"case_number"</span><span class="ot">,</span> <span class="st">"patient_sex"</span><span class="ot">,</span> <span class="st">"patient_age_today"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"fetch_fields"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"case_number"</span><span class="ot">,</span> <span class="st">"patient_sex"</span><span class="ot">,</span> <span class="st">"patient_date_of_birth"</span><span class="ot">]</span><span class="fu">,</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"include_fields"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"case_number"</span><span class="ot">,</span> <span class="st">"patient_sex"</span><span class="ot">,</span> <span class="st">"patient_age_today"</span><span class="ot">]</span><span class="fu">,</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"derived_added"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"patient_date_of_birth"</span><span class="ot">]</span><span class="fu">,</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"hashed"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"out"</span><span class="fu">:</span> <span class="st">"out/demographics.csv"</span><span class="fu">,</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"out_format"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"rows"</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"duration_ms"</span><span class="fu">:</span> <span class="fl">334.2735409969464</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>out/demographics.csv</strong></p>
<pre class="csv"><code>case_number,patient_sex,patient_age_today
a6e808094eb7,W,67
29a9c06d57ff,M,39</code></pre>
</section>
</section>
<section id="discussion-including-scalability-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="discussion-including-scalability-and-limitations">Discussion (including scalability and limitations)</h2>
<section id="ethical-and-legal-considerations" class="level3">
<h3 class="anchored" data-anchor-id="ethical-and-legal-considerations">Ethical and Legal Considerations</h3>
<p>All data handling complied with the European General Data Protection Regulation (GDPR, Datenschutz-Grundverordnung, DSGVO) and the Bavarian Krankenhausforschungsgesetz (KHG). Under §27 KHG, the secondary use of pseudonymized hospital routine data is explicitly permitted for research purposes without individual patient consent, provided appropriate safeguards are implemented. In line with Art. 32 DSGVO, state-of-the-art technical and organizational measures were applied to ensure confidentiality, integrity, and availability of the data. In accordance with these legal frameworks, patient identifiers were pseudonymized at the time of extraction and replaced with secure pseudonyms. Data linkage across domains was only performed within the pseudonymized environment. Access to raw datasets was limited to authorized staff bound by professional confidentiality and institutional governance rules. All extraction and transformation steps were performed within a secure computing environment physically located at the university hospital with no transfer of personal data to external servers or cloud infrastructure. Audit logs documented every data access and pipeline execution, ensuring full traceability.</p>
</section>
<section id="technical-and-methodological-considerations" class="level3">
<h3 class="anchored" data-anchor-id="technical-and-methodological-considerations">Technical and Methodological Considerations</h3>
<p>The extraction of routine clinical data from PDMS presents fundamental technical and methodological hurdles. While optimized for flexible clinical documentation and transactional performance, these systems inherently lack robust tools for analytical data extraction. The highly fragmented, denormalized, and proprietary data structures necessitate highly complex, advanced queries. As a result, extensive schema knowledge will be neccessary during the initial steps of data extraction. This SQL-based approach is highly effective for targeted retrieval of domains (e.g., demographics, ventilator parameters, laboratory results). However, direct SQL data extraction lacked a robust mechanism for role-based access control beyound user-specific database credentials, and logging user-specific extraction requests was necessary to comply with national regulations.</p>
<p>Although de-identification of sensitive parameters via hashing in SQL was technically feasible, and query-based parameter minimization is obvious, practical implementation and configuration for each individual use case proved highly complex. Furthermore, the use of custom units, varied time formats, and system-specific coding schemes requires extensive data harmonization. Consequently, without dedicated ETL pipelines, these rich datasets remain inaccessible to the majority of clinical researchers. All these hurdles have been described before. <span class="citation" data-cites="lamer_development_2023">(<a href="#ref-lamer_development_2023" role="doc-biblioref">13</a>)</span></p>
<p>Despite these challenges, structured ETL processes and a focus on standardization can successfully transform raw PDMS data into high-quality, analysis-ready datasets. Future work in the field should prioritize developing standardized export mechanisms (e.g., FHIR-based APIs), improving interoperability, and fostering collaborative data sharing infrastructures. In conclusion, routine data stored in PDMS contain unique opportunities for clinical and translational research, and the development of automation and decision-support systems. However secondary use requires overcoming substantial technical and methodological barriers. The approach presented here offers a reproducible methodology for extracting, transforming, harmonizing, and validating PDMS data, making them accessible to a wider research community while maintaining compliance with ethical and legal requirements.</p>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-moor_predicting_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Moor M, Bennett N, Plečko D, Horn M, Rieck B, Meinshausen N, et al. Predicting sepsis using deep learning across international sites: A retrospective development and validation study. eClinicalMedicine [Internet]. 2023 Aug [cited 2025 Nov 14];62:102124. Available from: <a href="https://linkinghub.elsevier.com/retrieve/pii/S2589537023003012">https://linkinghub.elsevier.com/retrieve/pii/S2589537023003012</a></div>
</div>
<div id="ref-schneeweiss_conducting_2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Schneeweiss S, Patorno E. Conducting <span>Real</span>-world <span>Evidence</span> <span>Studies</span> on the <span>Clinical</span> <span>Outcomes</span> of <span>Diabetes</span> <span>Treatments</span>. Endocrine Reviews [Internet]. 2021 Sep [cited 2025 Nov 14];42(5):658–90. Available from: <a href="https://academic.oup.com/edrv/article/42/5/658/6169054">https://academic.oup.com/edrv/article/42/5/658/6169054</a></div>
</div>
<div id="ref-hoque_impact_2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Hoque DME, Kumari V, Hoque M, Ruseckaite R, Romero L, Evans SM. Impact of clinical registries on quality of patient care and clinical outcomes: <span>A</span> systematic review. Kumar S, editor. PLOS ONE [Internet]. 2017 Sep [cited 2025 Nov 14];12(9):e0183667. Available from: <a href="https://dx.plos.org/10.1371/journal.pone.0183667">https://dx.plos.org/10.1371/journal.pone.0183667</a></div>
</div>
<div id="ref-solomon_integrating_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Solomon J, Dauber-Decker K, Richardson S, Levy S, Khan S, Coleman B, et al. Integrating <span>Clinical</span> <span>Decision</span> <span>Support</span> <span>Into</span> <span>Electronic</span> <span>Health</span> <span>Record</span> <span>Systems</span> <span>Using</span> a <span>Novel</span> <span>Platform</span> (<span>EvidencePoint</span>): <span>Developmental</span> <span>Study</span>. JMIR Formative Research [Internet]. 2023 Oct [cited 2025 Nov 14];7:e44065. Available from: <a href="https://formative.jmir.org/2023/1/e44065">https://formative.jmir.org/2023/1/e44065</a></div>
</div>
<div id="ref-holmes_why_2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Holmes JH, Beinlich J, Boland MR, Bowles KH, Chen Y, Cook TS, et al. Why <span>Is</span> the <span>Electronic</span> <span>Health</span> <span>Record</span> <span>So</span> <span>Challenging</span> for <span>Research</span> and <span>Clinical</span> <span>Care</span>? Methods of Information in Medicine [Internet]. 2021 May [cited 2025 Nov 12];60(01/02):032–48. Available from: <a href="http://www.thieme-connect.de/DOI/DOI?10.1055/s-0041-1731784">http://www.thieme-connect.de/DOI/DOI?10.1055/s-0041-1731784</a></div>
</div>
<div id="ref-maletzky_lifting_2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Maletzky A, Böck C, Tschoellitsch T, Roland T, Ludwig H, Thumfart S, et al. <a href="https://doi.org/10.2196/38557">Lifting <span>Hospital</span> <span>Electronic</span> <span>Health</span> <span>Record</span> <span>Data</span> <span>Treasures</span>: <span>Challenges</span> and <span>Opportunities</span></a>. JMIR medical informatics. 2022 Oct;10(10):e38557. </div>
</div>
<div id="ref-daniel_boie_scalable_2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Daniel Boie S, Meyer-Eschenbach F, Schreiber F, Giesa N, Barrenetxea J, Guinemer C, et al. A scalable approach for critical care data extraction and analysis in an academic medical center. International Journal of Medical Informatics [Internet]. 2024 Dec [cited 2025 Nov 12];192:105611. Available from: <a href="https://linkinghub.elsevier.com/retrieve/pii/S1386505624002740">https://linkinghub.elsevier.com/retrieve/pii/S1386505624002740</a></div>
</div>
<div id="ref-zuber_does_2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Zuber A, Kumpf O, Spies C, Höft M, Deffland M, Ahlborn R, et al. Does adherence to a quality indicator regarding early weaning from invasive ventilation improve economic outcome? <span>A</span> single-centre retrospective study. BMJ Open [Internet]. 2022 Jan [cited 2025 Nov 14];12(1):e045327. Available from: <a href="https://bmjopen.bmj.com/lookup/doi/10.1136/bmjopen-2020-045327">https://bmjopen.bmj.com/lookup/doi/10.1136/bmjopen-2020-045327</a></div>
</div>
<div id="ref-klopfenstein_developing_2025" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Klopfenstein SAI, Flint AR, Heeren P, Prendke M, Chaoui A, Ocker T, et al. Developing a <span>Scalable</span> <span>Annotation</span> <span>Method</span> for <span>Large</span> <span>Datasets</span> <span>That</span> <span>Enhances</span> <span>Alarms</span> <span>With</span> <span>Actionability</span> <span>Data</span> to <span>Increase</span> <span>Informativeness</span>: <span>Mixed</span> <span>Methods</span> <span>Approach</span>. Journal of Medical Internet Research [Internet]. 2025 May [cited 2025 Nov 14];27:e65961. Available from: <a href="https://www.jmir.org/2025/1/e65961">https://www.jmir.org/2025/1/e65961</a></div>
</div>
<div id="ref-ISO9075-1:2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">ISO/IEC. Information technology — database languages — SQL — part 1: Framework (SQL/framework). 6th ed. ISO/IEC 9075-1:2023(E) Geneva, Switzerland: International Organization for Standardization; 2023. </div>
</div>
<div id="ref-sqlalchemy_software" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Bayer M, contributors. SQLAlchemy, python SQL toolkit and object relational mapper. <a href="https://www.sqlalchemy.org/" class="uri">https://www.sqlalchemy.org/</a>; 2023. </div>
</div>
<div id="ref-schrader_pdms_pipeline_2025" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Schrader NB. Pdms_data_processing_pipeline [Internet]. 2025. Available from: <a href="https://github.com/DataScienceUKW/pdms_data_processing_pipeline">https://github.com/DataScienceUKW/pdms_data_processing_pipeline</a></div>
</div>
<div id="ref-lamer_development_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Lamer A, Moussa MD, Marcilly R, Logier R, Vallet B, Tavernier B. Development and usage of an anesthesia data warehouse: Lessons learnt from a 10-year project. Journal of Clinical Monitoring and Computing [Internet]. 2023 Apr [cited 2025 Nov 11];37(2):461–72. Available from: <a href="https://link.springer.com/10.1007/s10877-022-00898-y">https://link.springer.com/10.1007/s10877-022-00898-y</a></div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>